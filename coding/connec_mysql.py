#!/usr/bin/env python# -*- coding: utf-8 -*-# @Time    : 2018/5/26 下午10:50# @Author  : ziyi# @File    : connec_mysql.py# @Software: PyCharmimport pymysql# 创建数据库def cre_db(host, user, pw, name):    try:        # 数据库连接        db = pymysql.connect(host, user, pw, charset='utf8')        # 创建游标，通过连接与数据通信        cursor = db.cursor()        # 执行sql语句        cursor.execute('show databases')        rows = cursor.fetchall()        for row in rows:            tmp = "{}".format(row)            print(tmp)            # 判断数据库是否存在            if name == tmp:                cursor.execute('drop database if exists ' + name)            else:                cursor.execute('create database if not exists ' + name)                # 提交到数据库执行                db.commit()    except pymysql.Error as e:        print("Mysql Error {}: {}".format(e.args[0], e.args[1]))    finally:        # 关闭数据库连接        db.close()# db = pymysql.connect(db_host, db_user, db_password, db_database)## cursor = db.cursor()# cursor.execute('DROP TABLE IF EXISTS employer')# sql = """CREATE TABLE employer (FIRST_NAME CHAR(20) NOT NULL, LAST_NAME CHAR(20),# AGE INT, SEX CHAR(1),INCOME FLOAT)# """## cursor.execute(sql)# db.close()if __name__ == '__main__':    db_host = 'localhost'    db_user = 'root'    db_password = 'woaini36588'    db_database = 'mydb'    cre_db(db_host, db_user, db_password, db_database)